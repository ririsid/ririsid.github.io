<!DOCTYPE html><html lang="ko"><head><meta charset="UTF-8"/><meta property="og:site_name" content="Optional Unwrapping"/><link rel="canonical" href="https://ririsid.github.io/posts/2022-09-13-multiple-github-accounts-on-macos"/><meta name="twitter:url" content="https://ririsid.github.io/posts/2022-09-13-multiple-github-accounts-on-macos"/><meta property="og:url" content="https://ririsid.github.io/posts/2022-09-13-multiple-github-accounts-on-macos"/><title>macOS 다중 GitHub 계정 사용 | Optional Unwrapping</title><meta name="twitter:title" content="macOS 다중 GitHub 계정 사용 | Optional Unwrapping"/><meta property="og:title" content="macOS 다중 GitHub 계정 사용 | Optional Unwrapping"/><meta name="description" content="Swift, iOS 개발하기"/><meta name="twitter:description" content="Swift, iOS 개발하기"/><meta property="og:description" content="Swift, iOS 개발하기"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/feed.rss" type="application/rss+xml" title="Subscribe to Optional Unwrapping"/></head><head><link rel="stylesheet" href="/sundellsColors.css" type="text/css"/></head><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-QRTJYSRY7M"></script><script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());

gtag('config', 'G-QRTJYSRY7M');</script></head><body class="item-page"><header><div class="wrapper"><a href="/" class="site-name">Optional Unwrapping</a></div></header><div class="wrapper"><article><p>2022년 9월 13일</p><div class="content"><h1>macOS 다중 GitHub 계정 사용</h1><p>나는 두 개의 GitHub 계정을 사용한다. 개인 계정과 회사 계정이다.</p><p>처음에는 ssh-agent 등록을 통해 구분하려고 했다. 그런데 이게 귀찮고 햇갈리는 일이다.</p><p>다른 방법을 찾아보니 SSH <em>config</em> 파일을 이용해 구분하는 방법이 있었다.</p><p>여기서는 개인 계정을 기본 계정으로 사용하고, 회사 계정으로 일부 저장소를 사용한다고 가정하겠다.</p><p>여기서 모든 SSH 키 사용에 관한 모든 내용을 다루지 않으므로 SSH 키 사용 경험이 없거나 무언가 문제가 생긴다면 다음 GitHub의 문서를 참고하며 진행하자.</p><p><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">Generating a new SSH key and adding it to the ssh-agent - GitHub Docs</a></p><h3>기본(개인) SSH 키 등록</h3><p>우선 기본 SSH 키를 생성한다.</p><pre><code>ssh-keygen -t ed25519 -<span class="type">C</span> <span class="string">"your_email@example.com"</span>
</code></pre><p>기본 설정을 따르면 <em>id</em>ed25519*라는 키가 만들어졌을 것이다.</p><p>다음은 ssh-agent를 백그라운드로 실행한다.</p><pre><code>eval <span class="string">"$(ssh-agent -s)"</span>
</code></pre><p><code>~/.ssh/config</code> 파일을 수정(혹은 생성)한다.</p><pre><code><span class="type">Host</span> *
  <span class="type">AddKeysToAgent</span> yes
  <span class="type">UseKeychain</span> yes
  <span class="type">IdentityFile</span> ~/.<span class="property">ssh</span>/id_ed25519
</code></pre><p><strong>GitHub 문서에서는 위와 같이 되어 있지만 이렇게 하면 모든 호스트(<code>Host *</code>)가 기본 SSH 키를 사용하게 되므로 이후 추가할 회사용 SSH 키를 구분할 수 없게 된다.</strong></p><p>따라서 <code>~/.ssh/config</code> 파일을 다음과 같이 수정한다.</p><pre><code><span class="type">Host</span> github.<span class="property">com</span>
  <span class="type">AddKeysToAgent</span> yes
  <span class="type">UseKeychain</span> yes
  <span class="type">IdentityFile</span> ~/.<span class="property">ssh</span>/id_ed25519
</code></pre><p><code>Host</code>를 *에서 <em>github.com</em>으로 바꾸었다.</p><p>GitHub의 저장소는 호스트가 <em>github.com</em>이므로 이렇게 설정하면 모든 GitHub 저장소에 기본 SSH 키가 적용된다.</p><p>ssh-agent에 기본 SSH 키를 추가한다.</p><pre><code>ssh-add --apple-use-keychain ~/.<span class="property">ssh</span>/id_ed25519
</code></pre><p>다음 문서를 참고해 개인 GitHub 계정에 SSH 키를 추가한다.</p><p><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">Adding a new SSH key to your GitHub account - GitHub Docs</a></p><p>SSH 연결을 확인한다. [<a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/testing-your-ssh-connection">참고</a>]</p><pre><code>ssh -<span class="type">T</span> git@github.<span class="property">com</span>
</code></pre><p>다음과 같은 메시지가 나오면 성공이다.</p><blockquote><p>Hi <em>username</em>! You've successfully authenticated, but GitHub does not provide shell access.</p></blockquote><h3>회사용 SSH 키 등록</h3><p>회사용 SSH 키를 생성한다. 여기서는 임의로 <em>work</em>id<em>ed25519라 하겠다.</em></p><pre><code>ssh-keygen -t ed25519 -<span class="type">C</span> <span class="string">"your_company_email@example.com"</span> -f <span class="string">"work_id_ed25519"</span>
</code></pre><p><code>~/.ssh/config</code> 파일을 수정한다.</p><pre><code><span class="type">Host</span> github.<span class="property">com</span>
  <span class="type">AddKeysToAgent</span> yes
  <span class="type">UseKeychain</span> yes
  <span class="type">IdentityFile</span> ~/.<span class="property">ssh</span>/id_ed25519

<span class="type">Host</span> example.<span class="property">com</span>
  <span class="type">HostName</span> github.<span class="property">com</span>
  <span class="type">User</span> git
  <span class="type">AddKeysToAgent</span> yes
  <span class="type">UseKeychain</span> yes
  <span class="type">IdentityFile</span> ~/.<span class="property">ssh</span>/work_id_ed25519
</code></pre><p>회사용 설정을 추가했는데 <code>Host</code>가 <em>example.com</em>이고, <code>HostName</code>과 <code>User</code>도 추가됐다.</p><p><code>Host</code>의 <em>example.com</em>은 구분을 위한 임의의 값으로 실제 사용하는 호스트일 필요는 없다. <em>github.com</em>만 아니면 된다. 내 경우 회사 도메인을 사용했다.</p><p><code>HostName</code>과 <code>User</code>는 SSH 연결을 확인할 때 설명하도록 하겠다.</p><p>ssh-agent에 회사용 SSH 키를 추가한다.</p><pre><code>ssh-add --apple-use-keychain ~/.<span class="property">ssh</span>/work_id_ed25519
</code></pre><p>개인 GitHub 계정에 그랬던 것처럼 회사 GitHub 계정에도 SSH 키를 추가한다.</p><p><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/adding-a-new-ssh-key-to-your-github-account">Adding a new SSH key to your GitHub account - GitHub Docs</a></p><p>이제 SSH 연결을 확인한다.</p><p><a href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/testing-your-ssh-connection">Testing your SSH connection - GitHub Docs</a></p><p>중요한 건 호스트가 <em>example.com</em>이라는 것이다.</p><pre><code>ssh -<span class="type">T</span> git@example.<span class="property">com</span>
</code></pre><p><strong>이렇게 SSH 연결을 요청하면 실제로는 <em>config</em> 파일에서 <code>Host</code>가 <em>example.com</em>인 설정에 따라 <em>git@github.com</em>으로 <em>work</em>id<em>ed25519</em> 키를 사용해서 연결하게 된다.</strong></p><p>다음과 같은 메시지가 나오면 성공이다.</p><blockquote><p>Hi <em>company</em>username_! You've successfully authenticated, but GitHub does not provide shell access.</p></blockquote><h3>회사 저장소 주소 바꾸기</h3><p>마지막으로 회사 저장소의 원격지(remote) 주소를 바꾸어주어야 한다.</p><p>앞서와 마찬가지로 호스트를 <em>github.com</em>에서 <em>example.com</em>으로 바꾸자.</p><pre><code>git remote <span class="keyword">set</span>-url origin git@example.<span class="property">com</span>:<span class="type">YourCompany</span>/repository.<span class="property">git</span>
</code></pre><p>이제 <code>git fetch</code>를 해서 오류가 발생하지 않으면 모든 과정이 끝난 것이다.</p><h3>정리</h3><p>SSH는 <em>config</em> 파일의 <code>Host</code> 설정에 따라 적용할 SSH 키를 지정할 수 있고, 임의의 호스트도 설정에 따라 원래의 호스트로 연결할 수 있다.</p><p>이를 이용하면 몇 개의 계정을 사용하든 임의의 호스트를 설정해 호스트에 따라 원하는 SSH 키로 GitHub에 연결할 수 있다.</p><hr><h2>참고</h2><ul><li><a href="https://www.freecodecamp.org/news/manage-multiple-github-accounts-the-ssh-way-2dadc30ccaca/">How to manage multiple GitHub accounts on a single machine with SSH keys</a></li></ul></div><ul class="tag-list"><li><a href="/tags/macos">macOS</a></li><li><a href="/tags/github">GitHub</a></li><li><a href="/tags/git">Git</a></li></ul></article></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/feed.rss">RSS feed</a></p></footer></body></html>